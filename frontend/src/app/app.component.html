<!-- Show loading screen while connecting -->
@if (isConnecting()) {
<div class="connection-screen">
  <div class="paper-box indie-flower-regular">
    <div class="spinner"></div>
    <h2>Connecting to server...</h2>
    <p>Please wait while we establish connection</p>
  </div>
</div>
}

<!-- Show error screen if connection failed -->
@if (!isConnecting() && !isConnected()) {
<div class="connection-screen error">
  <div class="paper-box indie-flower-regular">
    <h2>Connection Failed</h2>
    <p>{{ connectionError() }}</p>
    <button (click)="ngOnInit()" class="retry-btn indie-flower-regular">Retry</button>
  </div>
</div>
}

<!-- Added duplicate connection error modal -->
@if (showDuplicateConnectionError()) {
<div class="modal-overlay">
  <div
    class="modal-paper indie-flower-regular duplicate-connection-modal"
    (click)="$event.stopPropagation()"
  >
    <h2>Duplicate Connection Detected</h2>
    <div class="modal-icon">⚠️</div>
    <p class="modal-description">
      You have an active connection in another browser tab or window. Only one connection per
      account is allowed at a time.
    </p>
    <p class="modal-description-secondary">
      Please close the other tab or refresh this page to reconnect.
    </p>
    <div class="modal-buttons">
      <button
        type="button"
        class="refresh-btn indie-flower-regular"
        (click)="window.location.reload()"
      >
        Refresh Page
      </button>
    </div>
  </div>
</div>
}

<!-- Show main app only when connected -->
@if (isConnected()) {
<main class="main">
  <app-header></app-header>
  <div class="content">
    <router-outlet />
  </div>
</main>
}
